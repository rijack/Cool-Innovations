<% colspan = 7 %>
<tr class="order_line <%= order_line.status.gsub(/\s+/, '-') %>" data-id="<%= order_line.id %>">

  <% if local_assigns[:show_client].present? %>
    <% colspan += 1 %>
    <td><%= order_line.order.client.name %></td>
  <% end %>
  <td><a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse<%= order_line.id %>"><i class="icon-plus"></i> <%= order_line.order.purchase_order %></a></td>
  <td><%= order_line.part.name %></td>
  <td class="editable qty" id="quantity-<%= order_line.id%>"><%= order_line.quantity %></td>
  <td><%= order_line.due_date %></td>
  <td class="editable comment" id="comment-<%= order_line.id%>"><%= order_line.comment %></td>
  <td class="editable comment" id="production_comment-<%= order_line.id%>"><%= order_line.production_comment %></td>
  <td class="actions">
    <span class="status btn btn-small" title="<%= order_line.status %>"><i class="icon-star-empty"></i></span>
    <%= link_to edit_order_path(order_line.order), :class => 'btn btn-small', :title => 'Edit' do%>
        <i class="icon-edit"></i>
    <% end %>
    <%= link_to order_line, method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-small btn-danger', :title => 'Delete' do%>
        <i class="icon-trash" alt="edit"></i>
    <% end %>
    <% if local_assigns[:show_client].present? %>
        <input type="checkbox" name="ship-order-lines" class="ship-lines" value="ol-<%= order_line.id%>">
    <% end %>
  </td>
</tr>
<tr>
    <td colspan="<%= colspan %>" class="order-line-info hide">
        <div class="accordion-body collapse" id="collapse<%= order_line.id %>">
            <!--<h4>Order line details</h4>-->
          <div class="order-line-info span11">
            <% if order_line.order.attachment? %>
                <h5>Order Attachment: <%= link_to order_line.order.attachment_file_name, order_line.order.attachment.url %></h5>
            <% end %>
          </div>
            <div class="process-info span7">
                <h5>Process</h5>
                <table class="table table-bordered table-condensed">
                  <thead>
                    <tr>
                      <th>Process Name</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% order_line.order_line_process_statuses.each do |process_status| %>
                        <tr class="process_status" data-id="<%= process_status.id %>">
                          <td><%= process_status.part_process.name %></td>
                          <td>
                            <div class="btn-group line-status" data-toggle="buttons-radio">
                              <% OrderLine::STATUSES.each do |order_line_status| %>
                                  <% extra_class = "" %>
                                  <% if order_line_status == process_status.status %>
                                      <% extra_class = "active" %>
                                      <% if process_status.status == "pending" %>
                                          <% extra_class = extra_class + " btn-warning" %>
                                      <% end %>
                                      <% if process_status.status == "in progress" %>
                                          <% extra_class = extra_class + " btn-info" %>
                                      <% end %>
                                      <% if process_status.status == "completed" %>
                                          <% extra_class = extra_class + " btn-success" %>
                                      <% end %>
                                  <% end %>
                                  <button class="btn btn-small <%= extra_class %>"><%= order_line_status %></button>
                              <% end %>
                            </div>
                          </td>
                        </tr>
                    <% end %>
                  </tbody>
                </table>
            </div>
            <div class="hardware-info span4">
                <h5>Hardware</h5>
                <table class="table table-bordered table-condensed">
                    <thead>
                        <tr>
                            <th>Hardware Name</th>
                            <th>Part Qty</th>
                            <th>Order Qty</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% order_line.part.required_hardwares.each do |hardware| %>
                            <tr>
                              <td><%= hardware.hardware.name %></td>
                              <td><%= hardware.quantity %></td>
                              <td><%= hardware.quantity * order_line.quantity %></td>
                            </tr>
                        <% end %>
                    </tbody>
                </table>
            </div>
        </div>
    </td>
</tr>
